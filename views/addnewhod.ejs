<!DOCTYPE html>
<html lang="en"> 
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>STUDOCS</title>
  <link href="/assets/img/logo.png" rel="icon">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css'>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="/css/addnewhod.css">

</head>
<body>
	<nav class="navbar navbar-expand-sm navbar-dark">
		<a class="navbar-brand logo" href="#">
		  <img src="/assets/img/logo.png" alt="Studocs">
		  STUDOCS
		</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent">
		  <span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
		  <ul class="navbar-nav">
			<li class="nav-item">
			  <a class="nav-link active" href="/principal/<%= id%>">Home</a>
			</li>
			<li class="nav-item">
			  <a class="nav-link active" href="/principal/<%= id%>/#banner">Services</a>
			</li>
			<li class="nav-item">
			  <a class="nav-link active" href="#" data-target="#Modal" data-toggle="modal">Sign Out <i class="fa fa-sign-out"></i></a>
			</li>
		  </ul>
		</div>
	</nav>
	  
      
    <br><br>
    <div class="container" style=" max-width: 90% !important;">
        <div class="row">
            <div class="col-md-offset-1 col-md-12">
                <div class="panel">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col col-sm-3 col-xs-12">
                                <h4 class="title">HOD <span>List</span></h4>
                            </div>
                            <div class="col-sm-9 col-xs-12 text-right">
                                <div class="btn_group">
                                    <form action="/principal/<%=id%>/search" method="POST">
                                        <input type="text" class="form-control" name="search" placeholder="Search name or id">
                                        <button class="btn btn-default" title="Reload"><i class="fa fa-refresh"></i></button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Full Name</th>
                                    <th>ID</th>
                                    <th>Department</th>
                                    <th>Email</th>
                                  <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% let number=0 %>   
                                <% applications.forEach(function(application) { %>
                                   <% number= number+1 %> 
                                   <tr>
                                       <td><%= number %></td>
                                       <td><%= application.name  %></td>
                                       <td><%= application.id %></td>
                                       <td><%= application.department %></td>
                                       <td><%= application.email  %></td>
                                       <td>
                                        <a href="#" onclick="confirmDelete('<%= application.id %>','<%= id %>')"><i class="fa fa-trash"></i></a>
                                    </td>
                                   </tr>
                                <% }); %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br><br>
        <div class="container" style=" max-width: 90% !important;">
            <div class="row">
                <div class="col-md-offset-1 col-md-12">
                    <div class="panel">
                        <div class="panel-heading">
                            <div class="row">
                                <div class="col col-sm-3 col-xs-12">
                                    <h4 class="title">Add <span>HOD</span></h4>
                                </div>
                            </div>
                        </div>
                    <div class="container">
                    <br>
                    <form action="/hodadd?id=<%= id%>" method="post">
                        <div class="row">
                        <div class="col">
                            <input type="text" class="form-control" placeholder="Name" name="name" required>
                        </div>
                        <div class="col">
                            <input type="text" class="form-control" placeholder="ID" name="id" required>
                        </div>
                        </div>
                        <br>
                        <div class="row">
                            <div class="col">
                                <input type="text" class="form-control" placeholder="Department" name="dept" required>
                            </div>
                            <div class="col">
                                <input type="email" class="form-control" placeholder="Email" name="email" required>
                            </div>
                        </div>
                        <br>
                        <div class="left">
                            <button type="submit" class="btn btn-success"> Generate </button>
                        </div>
                        
                        <br>
                    </form>
                    </div>
                            </div>
                        </div> 
                    </div>
                </div>
            </div>
        </div>

    <div class="modal fade" id="myModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">Delete User</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<!-- Modal body -->
				<div class="modal-body">
					Are you sure you want to delete this user?
				</div>
				<!-- Modal footer -->
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-danger" data-dismiss="modal">Delete</button>
				</div>
			</div>
		</div>
	</div>
    <div class="modal fade" id="Modal">
		<div class="modal-dialog">
			<div class="modal-content">
				<!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">Sign Out</h4>
					<button type="button" class="close" data-dismiss="modal">&times;</button>
				</div>
				<!-- Modal body -->
				<div class="modal-body">
					Do you want to sign out?
				</div>
				<!-- Modal footer -->
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-danger" data-dismiss="modal" onclick="window.location.href='/logout'" >Sign Out</button>
				</div>
			</div>
		</div>
	</div>
    <br><br>
    <script>
        function confirmDelete(id,returnid) {
          console.log(returnid)
    if (confirm("Are you sure you want to delete this entry?")) {
      deleteEntry(id,returnid);
    }
  }
  
  function deleteEntry(id,returnid) {
    fetch(`/deleteuser?id=${id}&user=hod&returnid=${returnid}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
    })
    .then(response => {
      if (response.ok) {
        // Refresh the page without changing the URL
        window.location.reload(false);
      } else {
        alert('Server error occurred. Entry could not be deleted.');
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('An error occurred. Entry could not be deleted.');
    });
  }
    </script> 
    
</body>
</html>